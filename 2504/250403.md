## Today I Learned

### [React-Query] useSuspenseInfiniteQueryë¡œ ì—¬ëŸ¬ refetched dataë¥¼ ë™ì‹œì— ë Œë”ë§ í•˜ê¸°

- ìƒí™© : ì¹¸ë°˜ Columnì˜ ì¹¸ë°˜ Cardë“¤ì„ í•„í„°ë§ í•œ ê²°ê³¼ëŠ” FEì¸¡ì—ì„œ ë°ì´í„°ë¥¼ ê°€ê³µí•˜ëŠ” ê²ƒì´ ì•„ë‹Œ GET ìš”ì²­ì„ í†µí•´ ê°€ì ¸ì˜¤ê³  ìˆë‹¤. ê° ì¹¸ë°˜ Columnì€ infiniteScrollì„ ìœ„í•´ useInfiniteQueryë¥¼ ì‚¬ìš© ì¤‘ì´ë‹¤.

- ë¬¸ì œ : í•„í„°ë§ ì¡°ê±´ì„ ê±´ GET ìš”ì²­ì„ ê° ì¹¸ë°˜ì˜ ìˆ˜ë§Œí¼ ë™ì‹œì— ë³´ë‚´ë„ ì‘ë‹µ ì‹œê°„ì´ ê°ì ë‹¤ë¥´ë¯€ë¡œ refetched dataê°€ ë Œë”ë§ë˜ëŠ” ì‹œê°„ì´ ë™ì‹œì ì´ì§€ ì•Šì•˜ë‹¤. ë””ìì´ë„ˆë¶„ê»˜ ìš”ì²­í•˜ì—¬ fallbackìœ¼ë¡œ ê·¸ë¦´ ìŠ¤ì¼ˆë ˆí†¤ UIë¥¼ ë§Œë“¤ê¸´ í–ˆì§€ë§Œ, í•´ë‹¹ UIë„ isLoadingì´ ì™„ë£Œë˜ëŠ” ì‹œì ì´ ë‹¤ë¥´ë¯€ë¡œ ë™ì‹œì— ì‚¬ë¼ì§€ì§„ ì•Šì•„ì„œ ì‚¬ìš©ì ê²½í—˜ì´ ê·¸ë‹¥ì´ì—ˆë‹¤ ... ê¹”ë”í•˜ê²Œ ëª¨ë“  ì¹¸ë°˜ Columnì´ ì‚¬ìš©í•˜ëŠ” ì¿¼ë¦¬ê°€ ëª¨ë‘ ì™„ë£Œë˜ì—ˆì„ ë•Œ ë™ì‹œì— ì—…ë°ì´íŠ¸ ë˜ë„ë¡ í•˜ê³  ì‹¶ì—ˆë‹¤.

- í•´ê²° : `useInfiniteQuery`ë¥¼ `useSuspenseInfiniteQuery`ë¡œ ë³€ê²½í•œë‹¤. -> âš ï¸ ë‹¨, ë°˜ë“œì‹œ ìƒìœ„ì— Suspense Boundaryê°€ ìˆì–´ì•¼ í•¨ ! ë°ì´í„° ë¡œë”© ì¤‘ì— promiseë¥¼ throwí•˜ì—¬ Suspense ë©”ì»¤ë‹ˆì¦˜ì„ íŠ¸ë¦¬ê±°í•˜ë©´, ì´ promiseë¥¼ í¬ì°©í•  Suspense ì»´í¬ë„ŒíŠ¸ê°€ ì–´ë”˜ê°€ì—ëŠ” ë°˜ë“œì‹œ í•„ìš”í•˜ê¸° ë•Œë¬¸... ì´ê±¸ ê¹Œë¨¹ê³  `useSuspenseInfiniteQuery`ë¡œë§Œ ë³€ê²½í–ˆë‹¤ê°€ ì„œë²„ ìš”ì²­ì—ì„œ 500ì—ëŸ¬ê°€ ë‚¬ì„ ë•Œ promiseë¥¼ ì¡ì„ ë°”ìš´ë”ë¦¬ê°€ ì—†ì–´ì„œ ë¬´í•œ refetchë¥¼ ê²ªì—ˆë‹¤.

- í•´ê²°ëœ ì´ìœ  :

  1. dataëŠ” í•­ìƒ `undefined`ê°€ ì•„ë‹ˆë‹¤ => dataë¥¼ ê°€ì ¸ì˜¤ëŠ” ë™ì•ˆì—ëŠ” `Suspenseê°€ ë™ì‘`í•˜ê¸° ë•Œë¬¸ì— ì¤‘ê°„ì— ë¹ˆ ì¹¸ë°˜ Column ë“±ì˜ ê¹œë¹¡ì„ ê°™ì€ í˜„ìƒì´ ë‚˜ì˜¤ì§€ ì•ŠëŠ” ê²ƒ. ì´ì „ ë°ì´í„°ë¥¼ í™”ë©´ì— ìœ ì§€ì‹œí‚¬ ìˆ˜ ìˆë‹¤.
  2. useSuspenseInfiniteQueryëŠ” ë°ì´í„° ë¡œë”© ì¤‘ì— isLoadingì„ ì‚¬ìš©í•˜ì§€ ì•Šì•„ë„ ìë™ìœ¼ë¡œ `Suspenseë¥¼ ë°œìƒì‹œí‚¨ë‹¤.`

- ì°¸ê³  ë§í¬ : https://tanstack.com/query/latest/docs/framework/react/reference/useSuspenseInfiniteQuery

## <br />

### [React] Suspenseê°€ ë™ì‘í•œë‹¤/ë°œìƒí•œë‹¤ëŠ” ê±´ ë¬´ìŠ¨ ëœ»ì¼ê¹Œ ?

- fetching ì¤‘ Suspenseë¥¼ í™œìš©í•  ì¼ì´ ë§ì€ë°, `Suspenseê°€ ë™ì‘í•œë‹¤` ... ë¼ëŠ” í‘œí˜„ì´ ì™€ë‹¿ì§€ ì•Šì•„ì„œ ì •í™•íˆ ì–´ë–¤ ëœ»ì¸ì§€ ê¶ê¸ˆí•´ì¡Œë‹¤. (ì„œìŠ¤íœìŠ¤ -> ì˜í™” ì¥ë¥´ë‚˜ ê¸´ì¥...ë¶ˆì•ˆ... ê°™ì€ ë‹¨ì–´ë¶€í„° ë– ì˜¤ë¥´ë‹ˆê¹Œ ğŸ™„)

- ì°¾ì•„ë³´ë‹ˆ, `Suspend(ì—°ê¸°í•˜ë‹¤, ì¤‘ë‹¨í•˜ë‹¤)`ë¡œì¨ì˜ `Suspense(ë¯¸ê²°, ìœ ì˜ˆ)`ë¼ê³  ì´í•´í•˜ë©´ ë  ê²ƒ ê°™ë‹¤. = ë°ì´í„°ê°€ ë¡œë“œë˜ëŠ” ë™ì•ˆ, ì»´í¬ë„ŒíŠ¸ë¥¼ "ì¼ì‹œ ì¤‘ë‹¨(suspend - ë Œë”ë§ ì¤‘ì§€)"ì‹œí‚¤ëŠ” ê²ƒ. Suspenseê°€ ë™ì‘í•œë‹¤ëŠ” ê±´ ë°ì´í„°ë¥¼ ê¸°ë‹¤ë¦¬ë©´ì„œ undefined ë˜ê±°ë‚˜ ë¶ˆì™„ì „í•œ UI ìƒíƒœë¥¼ ë³´ì—¬ì£¼ì§€ ì•ŠëŠ”ë‹¤ëŠ” ëœ»ê³¼ ê°™ë‹¤. Reactì˜ Suspenseë¥¼ ì‚¬ìš©í•˜ë©´, ë¡œë”© ìƒíƒœë¥¼ ë³„ë„ë¡œ ì²˜ë¦¬í•  í•„ìš” ì—†ì´ Suspense boundaryì—ì„œ ì²˜ë¦¬í•  ìˆ˜ ìˆë‹¤.

```tsx
// ì „í†µì ì¸ ë°©ì‹ì˜ fallback ë³´ì—¬ì£¼ê¸°
function Component() {
  const [data, setData] = useState(null);
  // ë°ì´í„° ë¡œë”© ë¡œì§...

  if (!data) return <Loading />;
  return <UI data={data} />; // ë°ì´í„°ê°€ ìˆì„ ë•Œë§Œ í‘œì‹œ
}
```

```tsx
// Suspenseë¥¼ í™œìš©í•˜ë©´,
// SuspenseBoundary ë‚´ì˜ ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸ì—ì„œëŠ” ...
<Suspense fallback={<Loading />}>
  <Component /> {/* ... ë°ì´í„°ê°€ ì¤€ë¹„ë  ë•Œê¹Œì§€ ë Œë”ë§ì´ ì¼ì‹œ ì¤‘ë‹¨ë¨ */}
</Suspense>;

// ìì‹ ì»´í¬ë„ŒíŠ¸ì—ì„œëŠ” ...
function Component() {
  const data = useSomeDataSource(); // ë°ì´í„°ê°€ ì—†ìœ¼ë©´ ìë™ìœ¼ë¡œ suspendë¨
  return <UI data={data} />; // í•­ìƒ ì™„ì „í•œ ë°ì´í„°ë¡œ ë Œë”ë§
}
```

- ì°¸ê³  ë§í¬ : https://ko.react.dev/reference/react/Suspense

## Today I Learned

### [TIL-WORDS]

- `에코시스템 ecosystem` : 하나의 플랫폼이나 기술을 중심으로 형성된 생태계 (= 관련된 도구, 라이브러리, 커뮤니티, 서비스 등)

## <br />

### [debug] SVG data URL에서 CSS 변수가 작동하지 않는 이유

- 상황: 원래 렌더링이 잘 되던 before 요소가 어느 순간부터 화면에 나오지 않았다. 실서비스에서는 잘 나오는데 스토리북에서만 나오지 않아서 혼란이 가중됨.

```scss
$range-connection: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='17' height='36' viewBox='0 0 17 36' fill='none'%3E%3Cpath fill-rule='evenodd' clip-rule='evenodd' d='M0 ... 36 0 36Z' fill='%23#{str-slice(#{$primary-100}, 2)}'/%3E%3C/svg%3E");

&::before {
  content: "";
  position: absolute;
  background-image: $range-connection;
  background-repeat: no-repeat;
}
```

- 디버깅: before 요소의 `background-image`의 fill에 할당된 색상값이 이상했다. 원래 `$primary-100`을 잘 불러오고 있었는데, 스토리북에서 color theme을 종류별로 적용하여 볼 수 있도록 테마 전환 기능이 추가되면서 hex값을 변환해오지 못하고 있었다.

  ```css
  // design-system/styles/theme/_theme.scss

  // 변경 전 : SCSS변수 사용
  $primary-100: #d2e7ff !default;
  ```

  ```css
  // 변경 후 : 기본 값으로 테마 컬러를 정의 후 ...
  :root {
    --primary-100: #d2e7ff !default;
  }

  // ...CSS 변수 사용
  $primary-100: var(--primary-100);
  ```

- 문제: 변경 전에는 `$primary-100`이 `#d2e7ff`였기 때문에 `str-slice(#{$primary-100}, 2)`가 `'%23d2e7ff'`로 잘 변환되었다. 그러나 변경 후에는 `str-slice(var(--primary-100))`이 되어 `ar(--primary-100)`을 반환... 최종적으로 `fill='%23ar(--primary-100)'` 값으로 사용하게 되어서 before 요소가 제대로 보이지 않았다.

- 원인: `SVG data URL`은 컴파일 타임에 평가되므로 SCSS가 CSS로 변환될 때 확정되어야 한다. 그러나 CSS 변수는 런타임(브라우저가 실행할 때 계산)에 평가되므로 `SVG data URL` 내부에서는 CSS 변수를 사용할 수 없었던 것 !

<br/>

> 해결 방법 : `clip-path`와 `background-color` 사용하기

```scss
$range-connection-path: path("M0 36H17...");

&::before {
  background-color: $primary-100; // CSS 변수가 런타임에 정상 평가됨
  clip-path: $range-connection-path; // 색상 정보 없는 정적 path 데이터
}
```

- background-color는 CSS변수(var(--primary-100))을 런타임에 정상적으로 평가하므로 테마 전환시에 동적으로 색상 변경이 가능하다.

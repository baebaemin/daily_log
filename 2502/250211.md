## Today I Learned

### [Refactor] React Query POST 로직 개선

```ts
// 개선 전
export const useScrap = () => {
  const queryClient = useQueryClient();

  // custom useListParams로부터 invalidateQueries에 넣을 요소를 구조 분해 할당 중
  const listParams = useListParams();
  const { requestData, pageableData } = listParams;
  const { idx, seq } = requestData;
  const { page, size } = pageableData;

  return useMutation({
    mutationFn: (data: ScrapRequest) => postScrap(data),
    onSuccess: async () => {
      await queryClient.invalidateQueries({
        queryKey: applicantsKeys.list(idx, seq, page || 0, size || 20),
      });
    },
    onError: () => {
      console.log("useScrap :: 스크랩 POST 실패");
    },
  });
};
```

```ts
// 개선 후
export const useScrap = () => {
  const queryClient = useQueryClient();
  // 중첩 구조분해 할당
  const {
    requestData: { idx, seq },
    pageableData: { page = 0, size = DEFAULT_PAGE_SIZE }, // default value는 상수화
  } = useListParams();

  return useMutation({
    mutationFn: (data: ScrapRequest) => postScrap(data),
    // async/await 제거 : invalidateQueries가 Promise를 반환하도록 함
    onSuccess: () => {
      return queryClient.invalidateQueries({
        queryKey: applicantsKeys.list(idx, seq, page, size),
      });
    },
    onError: (error) => {
      console.log("useScrap :: 스크랩 POST 실패");
    },
  });
};
```

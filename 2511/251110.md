## Today I Learned

### [Next.js] 로컬 개발 서버 실행하기

- 상황 : 새로운 프로젝트에 투입되어... 로컬 개발 서버 실행하는 것부터 에러를 발생시켰다 ^ㅡ^

  ```bash
  <!-- yarn keystone local 실행시 -->

  ⨯ Failed to start server
  [Error: getaddrinfo ENOTFOUND local.keystone.saramin.co.kr] {
  errno: -3008,
  code: 'ENOTFOUND',
  syscall: 'getaddrinfo',
  hostname: 'local.service.new-project.co.kr'
  }
  ```

- 원인 : Next.js 개발 서버가 `local.service.new-project.co.kr` 호스트명으로 실행되도록 설정되어있지만, 로컬 시스템의 `/etc/hosts` 파일에 해당 도메인이 등록되어있지 않아서 DNS 조회를 실패한 것

- 해결(macOS) : `sudo nano /etc/hosts`로 hosts 파일을 열어 `127.0.0.1 local.service.new-project.co.kr`을 추가함

  - nano 에디터에서 저장 및 종료

    1. `Control + O` - 저장 (Write Out)
    2. `Enter` - 파일명 확인
    3. `Control + X` - 종료 (Exit)

  - 기존에 진행하던 다른 서비스가 있지만 따로 주석처리 하지 않아도 됨

```bash
# /etc/hosts

##
# Host Database
#
# localhost is used to configure the loopback interface
# when the system is booting.  Do not change this entry.
##
127.0.0.1	localhost
255.255.255.255	broadcasthost
::1             localhost

# --- SWITCHHOSTS_CONTENT_START ---

127.0.0.1 local.service.before-project.co.kr
127.0.0.1 local.service.new-project.co.kr // 같은 IP에 매핑 가능
```

- 이곳에 포트 번호(`:3000`)는 적지 않는다
- 수정 후 서버 실행하면 Next.js가 HTTPS와 포트 3000을 자동으로 처리!

> `apps/keystone/package.json`의 `local` 스크립트:

```json
"local": "LOCAL_DEV=true next dev --experimental-https -H local.keystone.saramin.co.kr"
```

- `--experimental-https` 옵션으로 자체 서명 인증서를 사용하는 중
- `-H` 옵션으로 호스트명을 지정

## Today I Learned

### [TIL-WORDS]

- `rel`: relation 약어
- `FOIT`: Flash of Invisible Text - 폰트 로딩 전까지 텍스트가 잠깐 안 보이는 현상
- `FOUT`: Flash of Unstyled Text - 폰트 로딩 전까지 잠깐 기본 폰트로 보이는 현상
- `FOUC`: Flash of Unstyled Content - CSS 로딩 전까지 스타일링 되지 않은 콘텐츠가 잠깐 보이는 현상
- `cumulative`: 누적되는
- `Above the Fold`: 스크롤이나 클릭 없이 볼 수 있는 첫 웹페이지 진입 화면 ([링크](https://en.wikipedia.org/wiki/Above_the_fold))

## <br />

### [Next.js] localFont from "next/font/local"

```ts
// common/design-system-helper/localFonts.ts
import localFont from "next/font/local";

const pretendard = localFont({
  src: "../assets/fonts/PretendardVariable.woff2",
  display: "swap", // 기본 폰트 먼저 보여주기 (block은 안 보여줌)
  weight: "45 920",
  variable: "--font-pretendard",
  // preload: true, // 폰트를 미리 다운로드 - default는 true
});
```

```html
<!-- 실제 HTML 출력 -->
<head>
  <!-- preload: true일 때만 Next.js가 자동 생성 -->
  <link
    rel="preload"
    href="/_next/static/media/PretendardVariable.woff2"
    as="font"
    type="font/woff2"
    crossorigin="anonymous"
  />
</head>
```

`preload: true`(기본값)일 때

1. HTML 로드 & <link rel="preload"> 발견 -> 폰트 다운로드 시작
2. CSS 파싱
3. 폰트 적용이 필요한 부분 발견
4. 적용

`preload: false`일 때

1. HTML 로드
2. CSS 파싱
3. 폰트 적용이 필요한 부분 발견
4. 폰트 다운로드 시작 (FOUC 현상 발생 가능)
5. 폰트 적용

### <br />

`preload: true`를 쓰면 좋은 경우 :

- LCP(Largest Contentful Paint) 개선 : HTML과 폰트 로드 시간이 동시에 진행

- CLS(Cumulative Layout Shift) 개선 : 폰트가 바뀌면서 레이아웃이 밀리는 현상을 방지할 수 있음
- 모든 페이지에 사용되는 메인 폰트
- Above the fold(첫 화면)에 사용되는 폰트

`preload: true`를 쓰면 안 좋은 경우 :

- 잘 안 쓰는 특수 폰트
- 특정 페이지에서만 사용되는 폰트

- Next.js 공식 문서에서도 "진짜 중요한 폰트만" preload하라고 권장하고 있다.

### <br />

앱 전반 폰트 공통 적용 예시

```tsx
import pretendard from "@design-system/helper/localFonts";

export default function RootLayout() {
  return (
    <html lang="ko" className={pretendard.className}>
      <head>...</head>
      <body>...</body>
    </html>
  );
}
```

같은 font family인 다양한 파일을 사용하고 싶다면 src에 배열을 넘길 수도 있다.

```js
const roboto = localFont({
  src: [
    {
      path: "./Roboto-Regular.woff2",
      weight: "400",
      style: "normal",
    },
    {
      path: "./Roboto-Italic.woff2",
      weight: "400",
      style: "italic",
    },
  ],
});
```

- 참고 링크 1: http://nextjs.org/docs/pages/getting-started/fonts#local-fonts
- 참고 링크 2 : https://nextjs.org/docs/pages/api-reference/components/font#preload
